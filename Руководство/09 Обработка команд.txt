Любые команды, как введенные, так и вызванные триггерами или таймерами поочередно передаются методу ОбработатьКоманду. В этой функции Вы можете заменить команду другой командой или набором команд, как это показано в следующем примере:

public override string ОбработатьКоманду(string команда)
{
	if (команда == "вп")
		return "приказ все войти пент;войти пент";
	Match match;
	match = Regex.Match(команда, "^п( .+|$)");
	if (match.Success)
		return match.Result("подн$1");
	match = Regex.Match(команда, "^з (.+)");
	if (match.Success)
		return match.Result("спря;закол $1");
	match = Regex.Match(команда, "^у (.+)");
	if (match.Success)
		return match.Result("п $1;з $1");
	return base.ОбработатьКоманду(команда);
}

То есть, теперь при вводе "вп" выполняются команды "приказ все войти пент;войти пент", "п жертва" заменятся на "подн жертва" (причем, аргумент может отсутствовать), "з жертва" заменятся на "спря;закол жертва" (аргумент должен быть обязательно) и "у жертва" заменяется на "подн жертва;спря;закол жертва". Результат, возвращенный функцией ОбработатьКоманду, разбивается на отдельные команды и снова передается этой функции. Так происходит до тех пор, пока функция не вернет null или не передаст управление базовому методу. Это позволяет использовать псевдонимы и макросы в других псевдонимах и макросах. Также в этом методе Вы можете, при необходимости, выполнить команду без отправки ее на сервер (то есть, создать собственную внутреннюю команду клиента):

public override string ОбработатьКоманду(string команда)
{
	...
	if (команда == "время")
	{
		ЭлементВывода.ДобавитьЭхо(команда);
		ЭлементВывода.Добавить(new Строка(System.DateTime.Now.ToString(), 0x09));
		return null;
	}
	if (команда == "веса")
	{
		ЭлементВывода.ДобавитьЭхо(команда);
		ЭлементВывода.Добавить(0x0F, "Сила  Правая Левая  Двуруч    Сила  Правая Левая  Двуруч");
		ЭлементВывода.Добавить(" 01     01     00     01       26     23     13     36");
		ЭлементВывода.Добавить(" 02     02     01     03       27     23     14     37");
		ЭлементВывода.Добавить(" 03     03     01     04       28     24     14     38");
		ЭлементВывода.Добавить(" 04     04     02     06       29     24     15     39");
		ЭлементВывода.Добавить(" 05     05     02     07       30     25     15     40");
		ЭлементВывода.Добавить(" 06     06     03     09       31     25     15     40");
		ЭлементВывода.Добавить(" 07     07     03     10       32     25     15     40");
		ЭлементВывода.Добавить(" 08     08     04     12       33     25     16     41");
		ЭлементВывода.Добавить(" 09     09     04     13       34     26     16     42");
		ЭлементВывода.Добавить(" 10     10     05     15       35     26     16     42");
		ЭлементВывода.Добавить(" 11     11     05     16       36     26     17     43");
		ЭлементВывода.Добавить(" 12     12     06     18       37     26     17     43");
		ЭлементВывода.Добавить(" 13     13     06     19       38     27     17     44");
		ЭлементВывода.Добавить(" 14     14     07     21       39     27     17     44");
		ЭлементВывода.Добавить(" 15     15     07     22       40     27     18     45");
		ЭлементВывода.Добавить(" 16     16     08     24       41     27     18     45");
		ЭлементВывода.Добавить(" 17     17     08     25       42     28     18     46");
		ЭлементВывода.Добавить(" 18     18     09     27       43     28     18     46");
		ЭлементВывода.Добавить(" 19     19     09     28       44     28     19     47");
		ЭлементВывода.Добавить(" 20     20     10     30       45     28     19     47");
		ЭлементВывода.Добавить(" 21     20     11     31       46     29     19     48");
		ЭлементВывода.Добавить(" 22     21     11     32       47     29     19     48");
		ЭлементВывода.Добавить(" 23     21     12     33       48     29     19     48");
		ЭлементВывода.Добавить(" 24     22     12     34       49     29     20     49");
		ЭлементВывода.Добавить(" 25     22     13     35       50     30     20     50");
		return null;
	}
	...
	return base.ОбработатьКоманду(команда);
}

Теперь Вам доступны две собственные команды: команда "время", которая выводит красным цветом текущую дату и время, и команда "веса", которая выводит таблицу для определения максимального веса оружия, которое можно держать в правой, левой и обеих руках. Так как при самостоятельном выполнении команды функция прерывается и метод базового класса не вызывается, то не забывайте выводить эхо выполняемой команды (если, конечно, оно Вам нужно).
